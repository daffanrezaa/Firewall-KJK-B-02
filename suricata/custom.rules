# ========================================================
# SURICATA CUSTOM RULES - FIREWALL PROJECT KJK
# ========================================================

# --------------------------------------------------------
# 1. DETEKSI ICMP FLOOD (Ping of Death / Flood)
# --------------------------------------------------------
# Mendeteksi jika ada lebih dari 20 paket ICMP dalam 1 detik dari 1 IP
alert icmp any any -> any any (msg:"âš ï¸  WARNING: Possible ICMP Flood Detected"; threshold: type both, track by_src, count 20, seconds 1; classtype:attempted-dos; sid:1000001; rev:1;)

# --------------------------------------------------------
# 2. DETEKSI PORT SCANNING (Nmap)
# --------------------------------------------------------
# Mendeteksi scan SYN massive (Nmap default scan)
alert tcp any any -> any any (msg:"âš ï¸  WARNING: Nmap TCP Scan Detected"; flags:S; threshold: type both, track by_src, count 30, seconds 10; classtype:attempted-recon; sid:1000002; rev:1;)

# --------------------------------------------------------
# 3. DETEKSI SSH BRUTE FORCE
# --------------------------------------------------------
# Mendeteksi percobaan koneksi SSH berulang-ulang (Brute Force)
alert tcp any any -> any 22 (msg:"ðŸš¨ CRITICAL: Potential SSH Brute Force Attack"; flags:S; threshold: type both, track by_src, count 5, seconds 30; classtype:attempted-user; sid:1000003; rev:1;)

# --------------------------------------------------------
# 4. DETEKSI DATABASE ATTACK (MySQL)
# --------------------------------------------------------
# Mendeteksi akses ke port 3306 dari luar subnet Akademik (misal dari Guest/Mahasiswa)
# (Asumsi IP Akademik 10.20.20.0/24, jadi kalau bukan dari sana dianggap mencurigakan)
alert tcp !10.20.20.0/24 any -> any 3306 (msg:"âš ï¸  WARNING: Unauthorized Access to MySQL Database"; flags:S; classtype:policy-violation; sid:1000004; rev:1;)

# --------------------------------------------------------
# 5. DETEKSI AKSES DARI GUEST (Zone 10.20.50.x)
# --------------------------------------------------------
# Mendeteksi paket apapun dari Guest ke zona sensitif (Admin/Akademik)
alert ip 10.20.50.0/24 any -> 10.20.40.0/24 any (msg:"ðŸš¨ CRITICAL: Guest Zone attempting access to Admin Zone"; classtype:policy-violation; sid:1000005; rev:1;)
alert ip 10.20.50.0/24 any -> 10.20.20.0/24 any (msg:"ðŸš¨ CRITICAL: Guest Zone attempting access to Akademik Zone"; classtype:policy-violation; sid:1000006; rev:1;)
